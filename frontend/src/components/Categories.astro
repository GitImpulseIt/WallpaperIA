---
import { config } from '../config';
import { getTranslation } from '../i18n';

const { lang } = Astro.props;
const t = getTranslation(lang);
---

<section class="categories" id="categories">
  <div class="container">
    <h2 class="section-title">{t.categories.title}</h2>
    <p class="section-subtitle">{t.categories.subtitle}</p>

    <!-- Loading state -->
    <div class="loading-message" id="loadingMessage">
      <div class="spinner"></div>
      <p>Loading categories...</p>
    </div>

    <!-- Error state -->
    <div class="error-message" id="errorMessage" style="display: none;">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <p>{t.categories.loadingError}</p>
    </div>

    <!-- Categories Carousel -->
    <div class="categories-carousel" id="categoriesCarousel" style="display: none;">
      <div class="cat-carousel-wrapper">
        <button class="cat-carousel-btn carousel-prev" id="prevCategoriesBtn" aria-label="Previous">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>

        <div class="cat-carousel-container">
          <div class="cat-carousel-slides" id="carouselSlides"></div>
        </div>

        <button class="cat-carousel-btn carousel-next" id="nextCategoriesBtn" aria-label="Next">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      </div>

      <div class="cat-carousel-dots" id="carouselDots"></div>

      <div class="cat-carousel-info" id="carouselInfo">
        <span id="currentPage">1</span> / <span id="totalPages">1</span>
      </div>
    </div>
  </div>
</section>

<!-- Configuration pour le carrousel -->
<script is:inline define:vars={{ apiBaseUrl: config.apiBaseUrl, thumbnailsPath: config.thumbnailsPath, imageLoadError: t.categories.imageLoadError }}>
  // Expose configuration to carousel.js
  window.CAROUSEL_CONFIG = {
    apiBaseUrl: apiBaseUrl,
    thumbnailsPath: thumbnailsPath,
    imageLoadError: imageLoadError
  };
</script>
